<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Docker入门使用"/>




  <meta name="keywords" content="docker," />





  <link rel="alternate" href="/default" title="Time is the only currency" >




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1" />



<link rel="canonical" href="http://example.com/2022/03/01/Docker入门使用/"/>


<meta name="description" content="一、什么是Docker1.Docker出现的背景2.基本概念2.1镜像（image)镜像是一个只读的模板，它可以用来创建容器，一个镜像可以创建多个容器。 2.2容器(container)容器是用镜像创建的运行实例。它可以被启动、开始、停止、删除。每个容器都是互相隔离的，保证安全的平台。 2.3仓库(repository)仓库是集中存放镜像文件的场所。 仓库分为公开仓库和私有仓库两种形式。 二、Do">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker入门使用">
<meta property="og:url" content="http://example.com/2022/03/01/Docker%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Time is the only currency">
<meta property="og:description" content="一、什么是Docker1.Docker出现的背景2.基本概念2.1镜像（image)镜像是一个只读的模板，它可以用来创建容器，一个镜像可以创建多个容器。 2.2容器(container)容器是用镜像创建的运行实例。它可以被启动、开始、停止、删除。每个容器都是互相隔离的，保证安全的平台。 2.3仓库(repository)仓库是集中存放镜像文件的场所。 仓库分为公开仓库和私有仓库两种形式。 二、Do">
<meta property="og:locale">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220301233832414.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220301234918158.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000401215.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000726453.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000825025.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302001116563.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323220535207.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323224817682.png">
<meta property="og:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323224720812.png">
<meta property="article:published_time" content="2022-03-01T15:57:15.000Z">
<meta property="article:modified_time" content="2022-03-23T14:48:26.617Z">
<meta property="article:author" content="zjh">
<meta property="article:tag" content="docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220301233832414.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> Docker入门使用 - Time is the only currency </title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Time is the only currency</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Docker入门使用
        
      </h1>

      <time class="post-time">
          Mar 01 2022
      </time>
    </header>



    
            <div class="post-content">
            <h2 id="一、什么是Docker"><a href="#一、什么是Docker" class="headerlink" title="一、什么是Docker"></a>一、什么是Docker</h2><h3 id="1-Docker出现的背景"><a href="#1-Docker出现的背景" class="headerlink" title="1.Docker出现的背景"></a>1.Docker出现的背景</h3><h3 id="2-基本概念"><a href="#2-基本概念" class="headerlink" title="2.基本概念"></a>2.基本概念</h3><h4 id="2-1镜像（image"><a href="#2-1镜像（image" class="headerlink" title="2.1镜像（image)"></a>2.1镜像（image)</h4><p>镜像是一个只读的模板，它可以用来创建容器，一个镜像可以创建多个容器。</p>
<h4 id="2-2容器-container"><a href="#2-2容器-container" class="headerlink" title="2.2容器(container)"></a>2.2容器(container)</h4><p>容器是用镜像创建的运行实例。它可以被启动、开始、停止、删除。每个容器都是互相隔离的，保证安全的平台。</p>
<h4 id="2-3仓库-repository"><a href="#2-3仓库-repository" class="headerlink" title="2.3仓库(repository)"></a>2.3仓库(repository)</h4><p>仓库是集中存放镜像文件的场所。</p>
<p>仓库分为公开仓库和私有仓库两种形式。</p>
<h2 id="二、Docker安装"><a href="#二、Docker安装" class="headerlink" title="二、Docker安装"></a>二、Docker安装</h2><h3 id="1-确定是centos7以上版本"><a href="#1-确定是centos7以上版本" class="headerlink" title="1.确定是centos7以上版本"></a>1.确定是centos7以上版本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/redhat-release</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220301233832414.png" alt="image-20220301233832414"></p>
<h3 id="2-yum安装gcc相关"><a href="#2-yum安装gcc相关" class="headerlink" title="2.yum安装gcc相关"></a>2.yum安装gcc相关</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc</span><br><span class="line">yum -y install gcc-c++</span><br></pre></td></tr></table></figure>

<h3 id="3-卸载旧版本"><a href="#3-卸载旧版本" class="headerlink" title="3.卸载旧版本"></a>3.卸载旧版本</h3><h3 id="4-安装需要的软件包"><a href="#4-安装需要的软件包" class="headerlink" title="4.安装需要的软件包"></a>4.安装需要的软件包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>

<h3 id="5-设置stable镜像仓库"><a href="#5-设置stable镜像仓库" class="headerlink" title="5.设置stable镜像仓库"></a>5.设置stable镜像仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<h3 id="6-更新yum软件包索引"><a href="#6-更新yum软件包索引" class="headerlink" title="6.更新yum软件包索引"></a>6.更新yum软件包索引</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>

<h3 id="7-安装Docker-ce"><a href="#7-安装Docker-ce" class="headerlink" title="7.安装Docker ce"></a>7.安装Docker ce</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure>

<h3 id="8-启动Docker"><a href="#8-启动Docker" class="headerlink" title="8.启动Docker"></a>8.启动Docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line">docker version</span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220301234918158.png" alt="image-20220301234918158"></p>
<h3 id="9-配置镜像加速"><a href="#9-配置镜像加速" class="headerlink" title="9.配置镜像加速"></a>9.配置镜像加速</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/docker</span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<p>daemon.json内容如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash">网易云</span></span><br><span class="line">&#123;&quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;] &#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-卸载"><a href="#10-卸载" class="headerlink" title="10.卸载"></a>10.卸载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br><span class="line">yum -y remove docker-ce</span><br><span class="line">rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure>



<h2 id="三、基础命令"><a href="#三、基础命令" class="headerlink" title="三、基础命令"></a>三、基础命令</h2><h3 id="1-帮助命令"><a href="#1-帮助命令" class="headerlink" title="1.帮助命令"></a>1.帮助命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br><span class="line">docker info</span><br><span class="line">docker --help</span><br></pre></td></tr></table></figure>

<h3 id="2-镜像命令"><a href="#2-镜像命令" class="headerlink" title="2.镜像命令"></a>2.镜像命令</h3><h4 id="2-1-docker-images-查看镜像"><a href="#2-1-docker-images-查看镜像" class="headerlink" title="2.1 docker images 查看镜像"></a>2.1 docker images 查看镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p>命令作用：列出本地主机上的镜像</p>
<p>参数：</p>
<p>-a:列出本地所有的镜像（含中间映像层）</p>
<p>-q:只显示镜像ID</p>
<p>–digests:显示镜像的摘要信息</p>
<p>–no-trunc:显示完整的镜像信息</p>
<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000401215.png" alt="image-20220302000401215"></p>
<h4 id="2-2-docker-search-查找镜像"><a href="#2-2-docker-search-查找镜像" class="headerlink" title="2.2 docker search 查找镜像"></a>2.2 docker search 查找镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search [OPTIONS] 镜像名字</span><br></pre></td></tr></table></figure>

<p>[OPTIONS]参数说明：</p>
<p>–no-trunc:显示完整的镜像描述</p>
<p>-f &lt;过滤条件&gt;:列出收藏数不小于指定值的镜像</p>
<p>–automated:只列出automated build类型的镜像</p>
<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000726453.png" alt="image-20220302000726453"></p>
<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302000825025.png" alt="image-20220302000825025"></p>
<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220302001116563.png" alt="image-20220302001116563"></p>
<h4 id="2-3-docker-pull-拉取镜像"><a href="#2-3-docker-pull-拉取镜像" class="headerlink" title="2.3 docker pull 拉取镜像"></a>2.3 docker pull 拉取镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull image-name</span><br></pre></td></tr></table></figure>

<h4 id="2-4-docker-rmi-删除镜像命令"><a href="#2-4-docker-rmi-删除镜像命令" class="headerlink" title="2.4 docker rmi  删除镜像命令"></a>2.4 docker rmi  删除镜像命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f 镜像ID #删除单个</span><br><span class="line">docker rmi -f 镜像名1:TAG 镜像名2:TAG #删除多个</span><br><span class="line">docker rmi -f $(docker images -qa) #删除全部</span><br></pre></td></tr></table></figure>

<h3 id="3-容器命令"><a href="#3-容器命令" class="headerlink" title="3.容器命令"></a>3.容器命令</h3><p>容器命令只有在镜像存在的情况下才能执行。</p>
<h4 id="3-1新建并启动容器"><a href="#3-1新建并启动容器" class="headerlink" title="3.1新建并启动容器"></a>3.1新建并启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND][ARG...]</span><br></pre></td></tr></table></figure>

<p>OPTIONS说明：</p>
<p>–name=”容器新名字”：为容器指定一个名称；</p>
<p>-d:后台运行容器，并返回容器ID，也即启动守护式容器；</p>
<p>-i:以交互模式运行容器，通常与-t同时使用；</p>
<p>-t:为容器重新分配一个伪输入终端，通常与-i同时使用；</p>
<p>-P:随机端口映射；</p>
<p>-p:指定端口映射，有以下四种格式</p>
<p>​     ip:hostPort:containerPort</p>
<p>​     ip::containerPort,</p>
<p>​     hostPort:containerPort</p>
<p>​     containerPort</p>
<h4 id="3-2-列出当前所有正在运行的容器"><a href="#3-2-列出当前所有正在运行的容器" class="headerlink" title="3.2 列出当前所有正在运行的容器"></a>3.2 列出当前所有正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps [OPTIONS]</span><br></pre></td></tr></table></figure>

<p>[OPTIONS]说明</p>
<p>-a:列出当前所有正在运行的容器+历史运行过的</p>
<p>-l:显示最近创建的容器</p>
<p>-n:显示最近n个创建的容器</p>
<p>-q:静默模式，只显示容器编号</p>
<p>–no-trunc:不截断输出</p>
<h4 id="3-3-退出容器"><a href="#3-3-退出容器" class="headerlink" title="3.3 退出容器"></a>3.3 退出容器</h4><p>exit 容器停止退出</p>
<p>ctrl+P+Q容器不停止退出</p>
<h4 id="3-4-启动容器"><a href="#3-4-启动容器" class="headerlink" title="3.4 启动容器"></a>3.4 启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器ID或容器名</span><br></pre></td></tr></table></figure>

<h4 id="3-5重启容器"><a href="#3-5重启容器" class="headerlink" title="3.5重启容器"></a>3.5重启容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart 容器ID或容器名</span><br></pre></td></tr></table></figure>

<h4 id="3-6停止容器"><a href="#3-6停止容器" class="headerlink" title="3.6停止容器"></a>3.6停止容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID或容器名</span><br></pre></td></tr></table></figure>

<h4 id="3-7强制停止容器"><a href="#3-7强制停止容器" class="headerlink" title="3.7强制停止容器"></a>3.7强制停止容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker kill 容器ID或容器名</span><br></pre></td></tr></table></figure>

<h4 id="3-8删除已停止的容器"><a href="#3-8删除已停止的容器" class="headerlink" title="3.8删除已停止的容器"></a>3.8删除已停止的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID</span><br><span class="line"><span class="meta">#</span><span class="bash">一次性删除多个容器</span></span><br><span class="line">docker rm -f $(docker ps -a -a) </span><br><span class="line">docker ps -a -q | xargs docker rm</span><br></pre></td></tr></table></figure>

<h4 id="3-9启动守护式容器"><a href="#3-9启动守护式容器" class="headerlink" title="3.9启动守护式容器"></a>3.9启动守护式容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 容器名</span><br></pre></td></tr></table></figure>

<h4 id="3-10-查看容器日志"><a href="#3-10-查看容器日志" class="headerlink" title="3.10 查看容器日志"></a>3.10 查看容器日志</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --tail 容器ID</span><br></pre></td></tr></table></figure>

<p>-t 加入时间戳</p>
<p>-f 跟随最新的日志打印</p>
<p>–tail 数字 显示最后多少条</p>
<h4 id="3-11查看容器内运行的进程"><a href="#3-11查看容器内运行的进程" class="headerlink" title="3.11查看容器内运行的进程"></a>3.11查看容器内运行的进程</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器ID</span><br></pre></td></tr></table></figure>

<h4 id="3-12查看容器内部细节"><a href="#3-12查看容器内部细节" class="headerlink" title="3.12查看容器内部细节"></a>3.12查看容器内部细节</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器ID</span><br></pre></td></tr></table></figure>

<h4 id="3-13进入正在运行的容器并以命令行交互"><a href="#3-13进入正在运行的容器并以命令行交互" class="headerlink" title="3.13进入正在运行的容器并以命令行交互"></a>3.13进入正在运行的容器并以命令行交互</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器ID bashShell</span><br><span class="line">docker attach 容器ID #重新进入容器</span><br></pre></td></tr></table></figure>

<h4 id="3-14从容器内拷贝文件到主机上"><a href="#3-14从容器内拷贝文件到主机上" class="headerlink" title="3.14从容器内拷贝文件到主机上"></a>3.14从容器内拷贝文件到主机上</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器ID:容器内路径 目的主机路径</span><br></pre></td></tr></table></figure>



<h2 id="四、镜像"><a href="#四、镜像" class="headerlink" title="四、镜像"></a>四、镜像</h2><h2 id="五、容器数据卷"><a href="#五、容器数据卷" class="headerlink" title="五、容器数据卷"></a>五、容器数据卷</h2><blockquote>
<p>Docker是将应用与运行的环境打包形成容器运行的，运行可以伴随着容器，但是我们希望数据可以持久化。容器之间也有共享数据的需求。</p>
<p>容器产生的数据，如果不通过docker commit生成新的镜像，使得数据作为镜像的一部分保存下来，那么容器删除后，数据也就丢失了。因此，为了保存数据，docker提供数据卷的功能。</p>
</blockquote>
<h4 id="1-容器数据卷主要有以下作用："><a href="#1-容器数据卷主要有以下作用：" class="headerlink" title="1.容器数据卷主要有以下作用："></a>1.容器数据卷主要有以下作用：</h4><p>容器的持久化</p>
<p>容器间继承和共享数据</p>
<h4 id="2-数据卷相关命令"><a href="#2-数据卷相关命令" class="headerlink" title="2.数据卷相关命令"></a>2.数据卷相关命令</h4><h5 id="2-1-镜像挂载"><a href="#2-1-镜像挂载" class="headerlink" title="2.1 镜像挂载"></a>2.1 镜像挂载</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v /宿主机绝对路径目录:/容器内目录 镜像名</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323220535207.png" alt="image-20220323220535207"></p>
<h5 id="2-2查看数据卷是否挂载成功"><a href="#2-2查看数据卷是否挂载成功" class="headerlink" title="2.2查看数据卷是否挂载成功"></a>2.2查看数据卷是否挂载成功</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器id</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323224817682.png" alt="image-20220323224817682"></p>
<h5 id="2-3挂载之后，容器和主机之间的数据可以共享"><a href="#2-3挂载之后，容器和主机之间的数据可以共享" class="headerlink" title="2.3挂载之后，容器和主机之间的数据可以共享"></a>2.3挂载之后，容器和主机之间的数据可以共享</h5><h5 id="2-4-容器停止退出之后，主机修改后数据也可以同步"><a href="#2-4-容器停止退出之后，主机修改后数据也可以同步" class="headerlink" title="2.4 容器停止退出之后，主机修改后数据也可以同步"></a>2.4 容器停止退出之后，主机修改后数据也可以同步</h5><h5 id="2-5-带权限的命令"><a href="#2-5-带权限的命令" class="headerlink" title="2.5 带权限的命令"></a>2.5 带权限的命令</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -run -it -v /宿主机绝对路径:/容器内目录:ro 镜像名</span><br></pre></td></tr></table></figure>



<h2 id="六、Dockerfile"><a href="#六、Dockerfile" class="headerlink" title="六、Dockerfile"></a>六、Dockerfile</h2><p>Dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本</p>
<h4 id="1-Dockerfile内容"><a href="#1-Dockerfile内容" class="headerlink" title="1.Dockerfile内容"></a>1.Dockerfile内容</h4><p>1.1 每条保留字指令都必须为大写字母且后面要跟随至少一个参数</p>
<p>1.2 指令按照从上到下，顺序执行</p>
<p>1.3 #表示注释</p>
<p>1.4 每条指令都会创建一个新的镜像层，并对镜像进行提交</p>
<h4 id="2-Docker执行Dockerfile的大致流程"><a href="#2-Docker执行Dockerfile的大致流程" class="headerlink" title="2.Docker执行Dockerfile的大致流程"></a>2.Docker执行Dockerfile的大致流程</h4><p>2.1 docker从基础镜像运行一个容器</p>
<p>2.2 执行一条指令并对容器做出修改</p>
<p>2.3 执行类似docker commit的操作提交一个新的镜像层</p>
<p>2.4 docker再基于刚提交的镜像运行一个新容器</p>
<p>2.5 执行dockerfile中的下一条指令直到所有指令都执行完成</p>
<h4 id="3-DockerFile-保留关键字"><a href="#3-DockerFile-保留关键字" class="headerlink" title="3.DockerFile 保留关键字"></a>3.DockerFile 保留关键字</h4><p><strong>FROM</strong> 基础镜像，当前新镜像是基于哪个镜像的</p>
<p><strong>MAINTAINER</strong> 镜像维护者的姓名和邮箱地址</p>
<p><strong>RUN</strong> 容器构建时需要运行的命令</p>
<p><strong>EXPOSE</strong> 当前容器对外暴露出的端口</p>
<p><strong>WORKDIR</strong> 指定在创建容器后，终端默认登录的进来工作目录，一个落脚点</p>
<p><strong>ENV</strong> 用来在构建镜像过程中设置环境变量</p>
<p>如：ENV MY_PATH /usr/test，MY_PATH这个变量可以在后续的任何RUN指令中使用。也可以在其他指令中使用这些环境变量，比如：WORKDIR $MY_PATH</p>
<p><strong>ADD</strong> 将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar压缩包</p>
<p><strong>COPY</strong> 类似ADD，拷贝文件和目录到镜像中。将从构建上下文目录中&lt;源路径&gt;的文件/目录复制到新的一层的镜像内的&lt;目标路径&gt;位置</p>
<p><strong>VOLUME</strong> 容器数据卷，用于数据保持和持久化工作</p>
<p><strong>CMD</strong> </p>
<p>指定一个容器启动时要运行的命令</p>
<blockquote>
<p>有2种格式：</p>
<p>shell格式：CMD &lt;命令&gt;</p>
<p>exec 格式：CMD [“可执行文件”, “参数1”, “参数2”…]</p>
<p>参数列表格式：CMD[“参数1”, “参数2”…]。在指定了ENTRYPOINT指令后，用CMD指定具体的参数。</p>
</blockquote>
<p>Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换</p>
<p><strong>ENTRYPOINT</strong></p>
<p>指定一个容器启动时要运行的命令</p>
<p>ENTRYPOINT的目的和CMD一样，都是在指定容器启动程序及参数</p>
<p><strong>ONBUILD</strong></p>
<p>当构建一个被继承的Dockerfile时运行命令，父镜像在被子继承后父镜像的onbuild被触发。</p>
<p><img src="https://raw.githubusercontent.com/calm-always/picture/main/img/image-20220323224720812.png" alt="image-20220323224720812"></p>
<p>进度-15</p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/docker/">docker</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2022/03/03/Java-8-%E6%96%B0%E7%89%B9%E6%80%A7/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Java 8 新特性</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2022/02/27/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E3%80%8A%E8%BF%9C%E8%A7%81%E3%80%8B%EF%BC%8C%E5%85%B3%E4%BA%8E%E4%BD%A0%E7%9A%84%E8%81%8C%E4%B8%9A%E7%94%9F%E6%B6%AF/">
        <span class="next-text nav-default">读书笔记《远见》，关于你的职业生涯</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2022
    <span class="footer-author">zjh.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> and <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
